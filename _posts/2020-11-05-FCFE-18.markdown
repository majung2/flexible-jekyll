---
layout: post
title: "[íŒ¨ìŠ¤íŠ¸ìº í¼ìŠ¤ ìˆ˜ê°• í›„ê¸°] í”„ë¡ íŠ¸ì—”ë“œ ì¸ê°• 100% í™˜ê¸‰ ì±Œë¦°ì§€ 18íšŒì°¨ ë¯¸ì…˜"
date: 2020-11-05 15:25:21 +0300
description: # Add post description (optional)
img: FCFE/post18.jpg
tags: [íŒ¨ìŠ¤íŠ¸ìº í¼ìŠ¤, FastCampus, Front-End, ì¸ê°•, JavaScript]
---

ê°•ì˜

- [25 - 37 ë¡œê·¸ì¸ í˜ì´ì§€](#37-ë¡œê·¸ì¸-í˜ì´ì§€)
- [25 - 38 ì±… ì¶”ê°€í•˜ê¸°](#38-ì±…-ì¶”ê°€í•˜ê¸°)

---

# 37 ë¡œê·¸ì¸ í˜ì´ì§€

## íŒŒì¼ìƒì„±

### í”„ë¡œì íŠ¸ ì½”ë“œ ê¹ƒí—ˆë¸Œ

[í”„ë¡œì íŠ¸ ì½”ë“œ ê¹ƒí—ˆë¸Œ](https://github.com/xid-mark/fc-js-project)

- í”„ë¡œì íŠ¸ ì½”ë“œ ê¹ƒí—ˆë¸Œì—ì„œ clone
- fc-js-project í´ë”ì—ì„œ `npm install`
- `npm start` ë¡œì»¬ í˜¸ìŠ¤íŠ¸ 5000ìœ¼ë¡œ ì‘ì—… ê°€ëŠ¥

(ì½”ë“œëŠ” ëª¨ë‘ githubì—...)

- ë£¨íŠ¸ ìœ„ì¹˜ì— `login.html` ë§Œë“¤ê¸°!
- css í´ë”ì— `login.css` ìƒì„±
- js í´ë”ì— `login.js` ìƒì„±

<br>
<br>

## login.js

[login.js ê¹ƒí—ˆë¸Œ](https://github.com/majung2/fastcampus-frontend-all-in-one/blob/master/25-JS/js-project/js/login.js)

```
async function login(event) {
  event.preventDefault(); // submitì˜ default ë¡œì§ì´ ë°œìƒí•˜ì§€ ì•Šê²Œ ë§‰ê¸°
  event.stopPropagation(); // submit ì´ë²¤íŠ¸ê°€ ìƒìœ„ë¡œ ì „ë‹¬ë˜ì§€ ì•Šê²Œ ë§‰ê¸°

  const emailElement = document.querySelector("#email"); // dom element
  const passwordElement = document.querySelector("#password");

  const email = emailElement.value; // ê°’
  const password = passwordElement.value;

  try {
    const res = await axios.post("https://api.marktube.tv/v1/me", {
      email,
      password,
    });
    const { token } = res.data; // const token = res.data.token; ê³¼ ë™ì¼
    if (token === undefined) {
      return;
    }
    localStorage.setItem("token", token);
    location.assign("/");
  } catch (error) {
    const data = error.response.data;
    if (data) {
      const state = data.error;
      if (state === "USER_NOT_EXIST") {
        // ì„œë²„ê°€ ì •ì˜í•œ ì½”ë“œ
        alert("ì‚¬ìš©ìê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
      } else if (state === "PASSWORD_NOT_MATCH") {
        alert("ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.");
      }
    }
  }
}

function bindLoginButton() {
  const form = document.querySelector("#form-login");
  form.addEventListener("submit", login);
}

function getToken() {
  return localStorage.getItem("token");
}
function main() {
  // ë²„íŠ¼ì— ì´ë²¤íŠ¸ ì—°ê²°
  bindLoginButton();

  // í† í° ì²´í¬
  const token = getToken();
  if (token !== null) {
    location.assign("/");
    return;
  }
}

document.addEventListener("DOMContentLoaded", main);
```

- ë¡œê·¸ì¸ì •ë³´ test@marktube.tv / 1234

![25 - 37 ë¡œê·¸ì¸ í˜ì´ì§€]({{site.baseurl}}/assets/img/FCFE/post18-1.png)
<br>
<br>
<br>
<br>
<br>

# 38 ì±… ì¶”ê°€í•˜ê¸°

## íŒŒì¼ìƒì„±

- `add.html`, `add.css` íŒŒì¼ ìƒì„±
- [í”„ë¡œì íŠ¸ ì½”ë“œ ê¹ƒí—ˆë¸Œ](#í”„ë¡œì íŠ¸-ì½”ë“œ-ê¹ƒí—ˆë¸Œ)ì—ì„œ ì½”ë“œ ë³µë¶™

<br>
<br>

## add.js

[add.js ê¹ƒí—ˆë¸Œ](https://github.com/majung2/fastcampus-frontend-all-in-one/blob/master/25-JS/js-project/js/add.js)

```
function getToken() {
  return localStorage.getItem("token");
}

async function save(event) {
  event.preventDefault(); // htmlì—ì„œ submitì„ ëˆŒë €ì„ ë•Œ formì´ í•˜ëŠ” í–‰ë™ ë§‰ê¸°
  event.stopPropagation(); // formì„ ê°€ì§„ ìƒìœ„ DOMì—ë„ ì´ë²¤íŠ¸ ì „ë‹¬ ì•ˆë˜ê²Œ
  console.log("save");

  event.target.classList.add("was-validated"); // bootstrapê¸°ëŠ¥, ìœ íš¨ì„± ê²€ì‚¬ë¥¼ DOMì— ë³´ì—¬ì¤Œ

  const titleElement = document.querySelector("#title");
  const messageElement = document.querySelector("#message");
  const authorElement = document.querySelector("#author");
  const urlElement = document.querySelector("#url");

  const title = titleElement.value;
  const message = messageElement.value;
  const author = authorElement.value;
  const url = urlElement.value;

  if (title === "" || message === "" || author === "" || url === "") {
    return;
  }

  const token = getToken();
  if (token === null) {
    location.assign("/login");
    return;
  }

  try {
    await axios.post(
      "https://api.marktube.tv/v1/book",
      {
        title,
        message,
        author,
        url,
      },
      {
        headers: {
          Authorization: `Bearer ${token}`,
        },
      }
    );
    location.assign("/");
  } catch (error) {
    console.log("save error", error);
    alert("ì±… ì¶”ê°€ ì‹¤íŒ¨");
  }
}

function bindSaveButton() {
  const form = document.querySelector("#form-add-book");
  form.addEventListener("submit", save);
}

async function getUserByToken(token) {
  try {
    const res = await axios.get("https://api.marktube.tv/v1/me", {
      headers: {
        Authorization: `Bearer ${token}`,
      },
    });
    return res.data;
  } catch (error) {
    console.log("getUserByToken error", error);
    return null; // ë¬¸ì œ ë°œìƒ ì‹œ null ê°’ ë„˜ê¸°ê¸°
  }
}

async function main() {
  // ë²„íŠ¼ì— ì´ë²¤íŠ¸ ì—°ê²°
  bindSaveButton();

  // í† í° ì²´í¬
  const token = getToken();
  if (token === null) {
    location.assign("/login");
    return;
  }

  // í† í°ìœ¼ë¡œ ì„œë²„ì—ì„œ ë‚˜ì˜ ì •ë³´ ë°›ì•„ì˜¤ê¸°
  const user = await getUserByToken(token);
  if (user === null) {
    localStorage.clear();
    location.assign("/login");
    return;
  }
  console.log(user); // user ì •ë³´ ì œëŒ€ë¡œ ë“¤ì–´ì˜¤ëŠ”ì§€ í™•ì¸
}
document.addEventListener("DOMContentLoaded", main);
```

![25 - 38 ì±… ì¶”ê°€í•˜ê¸°]({{site.baseurl}}/assets/img/FCFE/post18-2.png)

---

<br>

#### 18íšŒì°¨ ì¸ì¦ìƒ·

![18íšŒì°¨ ì¸ì¦ìƒ·]({{site.baseurl}}/assets/img/FCFE/post18.jpg)
<br>  
<br>

ì˜¬ì¸ì› íŒ¨í‚¤ì§€ : í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œğŸ‘‰[https://bit.ly/3m0t8GM](https://bit.ly/3m0t8GM)
